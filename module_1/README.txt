1. У какого фильма из списка самый большой бюджет?
 Делаем выборку из датафрейма с условием, что значение из столбца budget было равно максимальному значению этого столбца с помощью функции max
 
 
 
2. Какой из фильмов самый длительный (в минутах)?
 Аналогично предыдущему заданию, только для столбца runtime
 
 
 
3. Какой из фильмов самый короткий (в минутах)?
 Аналогично предыдущему заданию, но используем функцию min
 
 
 
4. Какова средняя длительность фильмов?
 Используем функцию mean по столбцу runtime
 
 
 
5. Каково медианное значение длительности фильмов?
 Используем функцию median по столбцу runtime
 
 
 
6. Какой самый прибыльный фильм?
 Добавляем новый столбец profit, где profit=revenue-budget
 С помощью функции max выбираем максимальное значение в столбце profit
 
 
 
7.Какой фильм самый убыточный?
 С помощью функции min выбираем минимальное значение в столбце profit
 
 
 
8.У скольких фильмов из датасета объем сборов оказался выше бюджета?
 Делаем выборку из датафрейма с условием, что значение из столбца revenue больше чем из budget. Из получившейся выборки выделяем столбец с id фильма и применяем функцию nunique, которая посчитает количество уникальных id фильмов. (каждый фильм имеет уникальный id)
 
 
 
9.Какой фильм оказался самым кассовым в 2008 году?
 Создаем новый датафрейм который содержит фильмы только 2008 года релиза.
Ищем макчимальное значение в столбце revenue.



10.Самый убыточный фильм за период с 2012 по 2014 г. (включительно)?
Создаем новый датафрейм с фильмами релизом из указанного промежутка. Ищем минимальное значение в столбце profit



11.Какого жанра фильмов больше всего?
Данные из столбца genres преобразуем в список использую функцию str.split. С помощью функции explode разделяем по элементам из списков в столбце genres, расширяя при этом датафрейм. Применяя функцию value_conts по столбцу genres получаем список значений из столбца с отсортированным количеством встреч.Наш ответ превый в списке.



12. Фильмы какого жанра чаще всего становятся прибыльными?
Делаем выборку фильмов, где profit больше нуля. Остальное аналогично предыдущему заданию.



13.У какого режиссера самые большие суммарные кассовые сборы?
Разделяем данные из столбца director, используя функции str.split и explode. С помощью функции groupby группируем датафрейм по значениям из столбца director с применением фунции sum. В итоге получим датафрейм с именами режисеров с суммами всех численных значений из остальных столбцов для них. В полученном датафреме находим максамальное значение revenue.



14.Какой режисер снял больше всего фильмов в стиле Action?
Разделяем вышеуказанными методами значения в столбцах genres и director. Через условие оставляем в датафрейме только фильмы с жанром Action. Хотя наверное это можно было выполнить через функцию str.contains избавляясь от шагов по разделению столбца genres. С помощью функции value_counts получаем количество фильмов для каждого режисера. Список отсортирован и наш ответ первый.



15. Фильмы с каким актером принесли самые высокие кассовые сборы в 2012 году?
Оставляем в датафрейме только фильмы 2012 года. Для столбца cast используем функции str.split, explode, groupby с sum. В итоге получим датафрейм с именами актеров с суммами численных значений по сотальным столбцам для них. Находим максимальное значение столбца revenue.



16.Какой актер снялся в большем количестве высокобюджетных фильмов?
Оставляем в датафрейме только фильмы с бюджетом выше среднего. Рзделяем значения из столбца cast с помощью функций str.split и explode. С помощью функции value_counts список актеров с количеством фильмов в которых они снимались. Наш ответ первый.



17. В фильмах какого жанра больше всего снимался Nicolas Cage?
С помощью функции str.contains оставляем в датафрейме только фильмы с участием Кейджа. Остальное аналогично предыдущему заданию но для для столбца genres.



18. Самый убыточный фильм от Paramount Pictures
С помощью функции str.contains оставляем в датафрейме только фильмы снятые Paramount Pictures. Ищем минимальное значение в столбце profit.



19.Какой год стал самым успешным по суммарным кассовым сборам?
С помощью функции unique получаем список уникальных годов из столбца release_year. В цикле проходимся по каждому году из списка, вычисляем сумму значений столбца revenue и если эта сумма больше значения в переменной sum_rev, то сохраняем эту сумму в переменную. Также в момент перезаписи переменной sum_rev, в переменную good_year сохраняем текущий год из цикла. По завершению цикла в переменной good_year будет значение года с максимальными кассовыми сборами.



20.  Какой самый прибыльный год для студии Warner Bros?
Оставляем в датафрейме только фильмы снятые Warner Bros. Остальное аналогично предыдущему заданию.



21. В каком месяце за все годы суммарно вышло больше всего фильмов?
Используем функцию str.split с параметром expand=True. Параметр expand позволяет делить значения и расширять датафрейм не по строкам а по столбцам. Т.к. в столбце release_date формат записи м/д/г и нам нужен только месяц, просто заменим значения в столбце release_date на номер месяца. Если бы надо было еще знать например день, то пришлось бы добавлять столбец к датафрейму. Дальше группируем по месяцам и использованием функции count. Получаем датафрейм с номерами месяцев и количеством строк с этими месяцами причем в каждом столбце. При подсчете количества строк каждая строка содержала только один фильм. Нам остается найти максимальное значение в принципе в любом столбце, но лучше в imdb_id и номер месяца.



22.Сколько суммарно вышло фильмов летом? (за июнь, июль, август)
Производим те же операции что и в предыдущем задании. После получения датафрейма с месяцами и количествами фильмов выбираем значения из столбца imdb_id соответствующие месяцам лета и суммируем их.



23.Для какого режиссера зима – самое продуктивное время года?
Заменяем значения в столбце release_date на значения месяцев вышеуказанным способом. Оставляем в датафрейме только фильмы с релизом зимой. Разделяем столбец director по значениям и применяем функцию value_counts. Первый ответ наш.



24.Какая студия дает самые длинные названия своим фильмам по количеству символов?
Добавим в датафрейм столбец length с количеством символов в названии фильма с помощью функции str.len. Разделим столбец production_companies с помощью str.split и explode. Сгруппируем по студиям с использованием функции mean. Во всех столбцах с численным значением получим среднее для каждой студии. В столбце length находим максимальное значение и соответствующуб студию.



25. Описание фильмов какой студии в среднем самые длинные по количеству слов?
Разделим по словам описания фильмов в столбце  overview. Добавим столбец с количеством слов в описании фильма. Остальное аналогично пердыдущему заданию.



26. Какие фильмы входят в 1 процент лучших по рейтингу?
Отсортируем датафрейм по столбцу vote_average с помощью функции sort_values. Параметр ascending=False даст сортировку по убыванию. Всего фильмов в датафрейме 1889. Так один процент будет равен 1889*0,01=18,89 Округляем до меньшего целого, т.е. 18. Оставим в нашем отсортированном датафрейме только первые 18 фильмов. Можно конечно вручную сверять фильмы с вариантами ответов, но я немного облегчил себе задачу.Создал словарь с предложенными вариантами ответов и в цикле проверял есть ли предложенный фильм датафрейме.Если фильм есть заменяем на Yes, если нет то No. В итоге только первый вариант ответа имеет все Yes.



27.  Какие актеры чаще всего снимаются в одном фильме вместе?
С помощью функции str.split преобразуем данные из столбца cast в строку с именами актеров. Создадим пустые списки pairs и pairs_actors. В цикле пройдем по всем фильмам из датафрейма. В цикле будем в переменную actors будем сохранять список актеров из датафрейма. Используя функцию combinations из библиотеки itertools  из списка actors сформируем пары актеров и запишем их ы список pairs. Т.к. пары актеров в фильмах могут повторятся то через вложенный цикл будем проверять была ли уже эта пара актеров раньше, если нет то записываем пару в переменную pairs_actors. В итоге у нас есть список пар актеров, которые как минимум снимались в одном фильме вместе. Это намного лучше вариант, чем создавать список с парами всех актеров в датафрейме, где подавляющая часть актеров даже друг с другом не снималась. Создадим пустой датафрейм df в который будем записывать пару актеров и количество фильмом с их участием. По циклу пройдемся по списку пар актеров, проверяя в скольких фильмах они снимаются вместе. Переменная а будет счетчиком по которому мы будем переходить на новую строчку в датафрейме df при записи пары актеров и количества фильмов. По оканчанию цикла в датафрейме df находим максимальные значения. Всего 4 пары актеров, согласно предложенным вариантам ответов подходит только одна пара. 